<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>@hopenest_official Instagram Feed</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #fafafa;
    margin: 0;
    padding: 20px;
    color: #333;
  }
  .container {
    max-width: 1000px;
    margin: 0 auto;
  }
  .header {
    text-align: center;
    padding: 20px;
  }
  .header h1 {
    margin: 0;
    font-size: 28px;
  }
  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 20px;
  }
  .post {
    background: white;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }
  .post h3 {
    margin: 0 0 10px 0;
    font-size: 18px;
  }
  .post .date {
    color: #666;
    font-size: 14px;
    margin-bottom: 10px;
  }
  .post a {
    display: inline-block;
    margin-top: 10px;
    color: #E4405F;
    text-decoration: none;
    font-weight: bold;
  }
  .loading {
    text-align: center;
    padding: 40px;
    color: #666;
  }
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>@hopenest_official Instagram Feed</h1>
    </div>
    <div id="feedList" class="grid">
      <div class="loading">RSS 피드를 불러오는 중...</div>
    </div>
  </div>

<script>
function getUrlParameter(name) {
    name = name.replace(/[[]/, '\\[').replace(/[\]]/, '\\]');
    var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
    var results = regex.exec(location.search);
    return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
}

function loadRSSFeed(username) {
    const feedUrl = `${username}_feed.xml`;
    fetch(feedUrl)
        .then(response => response.text())
        .then(data => {
            const parser = new DOMParser();
            const xmlDoc = parser.parseFromString(data, "text/xml");
            displayFeed(xmlDoc);
        })
        .catch(error => {
            document.getElementById('feedList').innerHTML = `<div class="loading">RSS 피드를 불러올 수 없습니다: ${error.message}</div>`;
        });
}

function displayFeed(xmlDoc) {
    const items = xmlDoc.querySelectorAll('item');
    const feedList = document.getElementById('feedList');
    if (items.length === 0) {
        feedList.innerHTML = '<div class="loading">게시물이 없습니다.</div>';
        return;
    }
    let html = '';
    items.forEach(item => {
        const title = item.querySelector('title').textContent;
        const link = item.querySelector('link').textContent;
        const pubDate = item.querySelector('pubDate').textContent;
        const date = new Date(pubDate);
        const formattedDate = date.toLocaleDateString('ko-KR') + ' ' + date.toLocaleTimeString('ko-KR');
        html += `
            <div class="post">
                <h3>${title}</h3>
                <div class="date">${formattedDate}</div>
                <a href="${link}" target="_blank">Instagram에서 보기</a>
            </div>
        `;
    });
    feedList.innerHTML = html;
}

window.onload = function() {
    const username = getUrlParameter('user') || 'hopenest_official';
    loadRSSFeed(username);
}
</script>
</body>
</html>
